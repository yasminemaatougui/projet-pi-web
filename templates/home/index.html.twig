{% extends 'base.html.twig' %}

{% block title %}Accueil - Art Connect{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <style>
        /* ===== HERO CAROUSEL ===== */
        .hero-carousel .carousel-item {
            min-height: 420px;
            position: relative;
            overflow: hidden;
        }
        .hero-carousel .carousel-item::before {
            content: '';
            position: absolute;
            inset: 0;
            z-index: 1;
        }
        .hero-slide-1::before { background: linear-gradient(135deg, rgba(30,15,117,0.92) 0%, rgba(55,133,216,0.8) 100%); }
        .hero-slide-2::before { background: linear-gradient(135deg, rgba(28,29,171,0.9) 0%, rgba(191,140,225,0.8) 100%); }
        .hero-slide-3::before { background: linear-gradient(135deg, rgba(55,133,216,0.9) 0%, rgba(30,15,117,0.85) 100%); }

        .hero-carousel .carousel-caption {
            position: relative;
            z-index: 2;
            left: 0; right: 0; bottom: 0;
            padding: 4rem 2rem;
            text-align: left;
            max-width: 720px;
        }
        .hero-carousel .carousel-caption h2 {
            font-family: 'Sora', sans-serif;
            font-weight: 700;
            font-size: 2.4rem;
            line-height: 1.15;
            margin-bottom: 1rem;
        }
        .hero-carousel .carousel-caption p {
            font-size: 1.1rem;
            color: rgba(255,255,255,0.88);
            max-width: 560px;
        }
        .hero-carousel .carousel-indicators [data-bs-target] {
            width: 10px; height: 10px;
            border-radius: 50%;
            border: none;
            opacity: 0.5;
        }
        .hero-carousel .carousel-indicators .active { opacity: 1; }
        .hero-carousel .btn-hero {
            border-radius: 12px;
            padding: 0.65rem 1.6rem;
            font-weight: 600;
            font-size: 0.95rem;
        }

        @media (max-width: 768px) {
            .hero-carousel .carousel-item { min-height: 340px; }
            .hero-carousel .carousel-caption { padding: 2.5rem 1.2rem; }
            .hero-carousel .carousel-caption h2 { font-size: 1.6rem; }
        }

        /* ===== SECTION HEADERS ===== */
        .section-head {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.4rem;
        }
        .section-head h2 {
            font-family: 'Sora', sans-serif;
            font-weight: 700;
            font-size: 1.5rem;
            color: #1E0F75;
            margin: 0;
        }
        .section-head .see-all {
            font-weight: 600;
            font-size: 0.9rem;
            color: #3785D8;
            text-decoration: none;
            display: flex; align-items: center; gap: 0.3rem;
            transition: color 0.2s;
        }
        .section-head .see-all:hover { color: #1E0F75; }

        /* ===== EVENT CARDS ===== */
        .ev-card {
            background: #fff;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 6px 20px rgba(30,15,117,0.08);
            border: 1px solid rgba(30,15,117,0.06);
            transition: transform 0.2s, box-shadow 0.2s;
            height: 100%;
            display: flex;
            flex-direction: column;
        }
        .ev-card:hover { transform: translateY(-4px); box-shadow: 0 12px 28px rgba(30,15,117,0.14); }
        .ev-card-img {
            height: 170px;
            display: flex; align-items: center; justify-content: center;
            font-size: 2.5rem;
        }
        .ev-card-img img { width: 100%; height: 100%; object-fit: cover; }
        .ev-card-body { padding: 1rem 1.1rem; flex: 1; display: flex; flex-direction: column; }
        .ev-card-body h3 { font-size: 1rem; font-weight: 700; color: #1E0F75; margin-bottom: 0.3rem; }
        .ev-card-meta { font-size: 0.8rem; color: #666; margin-bottom: 0.6rem; }
        .ev-card-meta i { color: var(--ac-mid); width: 16px; text-align: center; margin-right: 0.2rem; }
        .ev-card-price {
            margin-top: auto;
            display: flex; justify-content: space-between; align-items: center;
        }

        /* ===== PRODUCT CARDS ===== */
        .prod-card {
            background: #fff;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 6px 20px rgba(30,15,117,0.08);
            border: 1px solid rgba(30,15,117,0.06);
            transition: transform 0.2s, box-shadow 0.2s;
            height: 100%;
            display: flex; flex-direction: column;
        }
        .prod-card:hover { transform: translateY(-4px); box-shadow: 0 12px 28px rgba(30,15,117,0.14); }
        .prod-card-img {
            height: 180px;
            background: linear-gradient(135deg, #f0eef9, #e8edf5);
            display: flex; align-items: center; justify-content: center;
            font-size: 2.5rem;
        }
        .prod-card-img img { width: 100%; height: 100%; object-fit: cover; }
        .prod-card-body { padding: 1rem 1.1rem; flex: 1; display: flex; flex-direction: column; }
        .prod-card-body h3 { font-size: 1rem; font-weight: 700; color: #1E0F75; margin-bottom: 0.35rem; }
        .prod-card-body p { font-size: 0.85rem; color: #555; flex: 1; }
        .prod-card-foot {
            display: flex; justify-content: space-between; align-items: center;
            margin-top: auto;
        }
        .prod-price { font-weight: 800; color: var(--ac-mid); font-size: 1.05rem; }

        /* ===== FORUM CARDS ===== */
        .forum-card {
            background: #fff;
            border-radius: 14px;
            padding: 1.2rem 1.3rem;
            box-shadow: 0 4px 14px rgba(30,15,117,0.06);
            border: 1px solid rgba(30,15,117,0.06);
            transition: transform 0.2s;
            height: 100%;
        }
        .forum-card:hover { transform: translateY(-3px); }
        .forum-card h3 { font-size: 1rem; font-weight: 700; color: #1E0F75; margin-bottom: 0.4rem; }
        .forum-card p { font-size: 0.85rem; color: #555; margin-bottom: 0.6rem; }
        .forum-card-meta { font-size: 0.78rem; color: #888; }

        /* ===== CTA BANNER ===== */
        .cta-banner {
            background: linear-gradient(135deg, var(--ac-deep) 0%, var(--ac-mid) 60%, var(--ac-blue) 100%);
            border-radius: 20px;
            padding: 2.5rem 2rem;
            color: #fff;
            position: relative;
            overflow: hidden;
        }
        .cta-banner::after {
            content: '';
            position: absolute;
            width: 300px; height: 300px;
            background: rgba(255,255,255,0.04);
            border-radius: 50%;
            right: -80px; top: -80px;
        }
        .cta-banner h2 { font-family: 'Sora', sans-serif; font-weight: 700; }

        /* ===== ABOUT SECTION ===== */
        .about-section h2 { font-family: 'Sora', sans-serif; font-weight: 700; color: #1E0F75; }
        .about-card {
            background: #fff;
            border: 1px solid rgba(30,15,117,0.1);
            border-radius: 16px;
            padding: 1.2rem;
            box-shadow: 0 6px 16px rgba(30,15,117,0.06);
            height: 100%;
        }
        .about-icon {
            width: 44px; height: 44px;
            border-radius: 12px;
            display: flex; align-items: center; justify-content: center;
            font-size: 1.3rem;
            margin-bottom: 0.8rem;
        }

        /* ===== GUEST OVERRIDES ===== */
        .landing-wrap { max-width: 1180px; margin: 0 auto; }
    </style>
{% endblock %}

{% block body %}
{% if app.user %}
    {# ================================================================ #}
    {# FRONTOFFICE LANDING ‚Äî for Artist / Participant                    #}
    {# ================================================================ #}

    {# ---------- HERO CAROUSEL ---------- #}
    <div id="heroCarousel" class="carousel slide hero-carousel mb-5" data-bs-ride="carousel" data-bs-interval="5000">
        <div class="carousel-indicators">
            <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="0" class="active"></button>
            <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="1"></button>
            <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="2"></button>
        </div>
        <div class="carousel-inner" style="border-radius: 20px; overflow: hidden;">
            <div class="carousel-item active hero-slide-1">
                <div class="carousel-caption">
                    <h2>Bienvenue, {{ app.user.prenom }}</h2>
                    <p>D√©couvrez les √©v√©nements artistiques, r√©servez vos places et participez √† des ateliers cr√©atifs adapt√©s √† tous.</p>
                    <a href="{{ path('app_evenement_index') }}" class="btn btn-light btn-hero me-2">Explorer les √âv√©nements</a>
                    <a href="{{ path('app_produit_index') }}" class="btn btn-outline-light btn-hero">Voir la Boutique</a>
                </div>
            </div>
            <div class="carousel-item hero-slide-2">
                <div class="carousel-caption">
                    <h2>Boutique Solidaire</h2>
                    <p>Soutenez les artistes en achetant des cr√©ations uniques. Chaque achat contribue √† l'art inclusif.</p>
                    <a href="{{ path('app_produit_index') }}" class="btn btn-light btn-hero me-2">Parcourir la Boutique</a>
                    <a href="{{ path('app_donation_new') }}" class="btn btn-outline-light btn-hero">Faire un Don</a>
                </div>
            </div>
            <div class="carousel-item hero-slide-3">
                <div class="carousel-caption">
                    <h2>Rejoignez la Communaut√©</h2>
                    <p>√âchangez avec d'autres passionn√©s, partagez vos id√©es et participez aux discussions du forum.</p>
                    <a href="{{ path('app_forum_index') }}" class="btn btn-light btn-hero me-2">Acc√©der au Forum</a>
                    <a href="{{ path('app_reservation_my') }}" class="btn btn-outline-light btn-hero">Mes R√©servations</a>
                </div>
            </div>
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#heroCarousel" data-bs-slide="prev">
            <span class="carousel-control-prev-icon"></span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#heroCarousel" data-bs-slide="next">
            <span class="carousel-control-next-icon"></span>
        </button>
    </div>

    {# ---------- EVENTS SECTION ---------- #}
    <section class="mb-5">
        <div class="section-head">
            <h2><i class="fas fa-calendar-alt me-2" style="color:var(--ac-mid)"></i>√âv√©nements √† venir</h2>
            <a href="{{ path('app_evenement_index') }}" class="see-all">Voir tout <i class="fas fa-arrow-right"></i></a>
        </div>
        <div class="row g-3">
            {% for event in latestEvents %}
                <div class="col-sm-6 col-lg-4">
                    <a href="{{ path('app_evenement_show', {id: event.id}) }}" class="text-decoration-none">
                        <div class="ev-card">
                            <div class="ev-card-img" style="background: linear-gradient({{ loop.index * 40 }}deg, rgba(30,15,117,0.12), rgba(55,133,216,0.12));">
                                {% if event.image %}
                                    <img src="{{ event.image }}" alt="{{ event.titre }}">
                                {% else %}
                                    üé®
                                {% endif %}
                            </div>
                            <div class="ev-card-body">
                                <h3>{{ event.titre }}</h3>
                                <div class="ev-card-meta">
                                    <div><i class="fas fa-clock"></i> {{ event.dateDebut ? event.dateDebut|date('d/m/Y √† H\\hi') : 'Date √† confirmer' }}</div>
                                    <div><i class="fas fa-map-marker-alt"></i> {{ event.lieu }}</div>
                                </div>
                                <div class="ev-card-price">
                                    <span class="badge {{ event.prix ? 'bg-warning text-dark' : 'bg-success' }}">
                                        {{ event.prix ? event.prix ~ ' TND' : 'Gratuit' }}
                                    </span>
                                    <span class="badge bg-light text-dark">
                                        <i class="fas fa-users"></i> {{ event.nbPlaces }} places
                                    </span>
                                </div>
                            </div>
                        </div>
                    </a>
                </div>
            {% else %}
                <div class="col-12">
                    <div class="text-center text-muted py-4">Aucun √©v√©nement disponible pour le moment.</div>
                </div>
            {% endfor %}
        </div>
    </section>

    {# ---------- PRODUCTS SECTION ---------- #}
    <section class="mb-5">
        <div class="section-head">
            <h2><i class="fas fa-store me-2" style="color:var(--ac-blue)"></i>Boutique Solidaire</h2>
            <a href="{{ path('app_produit_index') }}" class="see-all">Voir tout <i class="fas fa-arrow-right"></i></a>
        </div>
        <div class="row g-3">
            {% for produit in latestProduits %}
                <div class="col-sm-6 col-lg-3">
                    <a href="{{ path('app_produit_show', {id: produit.id}) }}" class="text-decoration-none">
                        <div class="prod-card">
                            <div class="prod-card-img">
                                {% if produit.image %}
                                    <img src="{{ produit.image }}" alt="{{ produit.nom }}">
                                {% else %}
                                    üõçÔ∏è
                                {% endif %}
                            </div>
                            <div class="prod-card-body">
                                <h3>{{ produit.nom }}</h3>
                                <p>{{ produit.description|length > 80 ? produit.description|slice(0, 80) ~ '‚Ä¶' : produit.description }}</p>
                                <div class="prod-card-foot">
                                    <span class="prod-price">{{ produit.prix }} TND</span>
                                    {% if produit.stock > 0 %}
                                        <span class="badge bg-success">En stock</span>
                                    {% else %}
                                        <span class="badge bg-danger">Rupture</span>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </a>
                </div>
            {% else %}
                <div class="col-12">
                    <div class="text-center text-muted py-4">Aucun produit disponible pour le moment.</div>
                </div>
            {% endfor %}
        </div>
    </section>

    {# ---------- FORUM SECTION ---------- #}
    <section class="mb-5">
        <div class="section-head">
            <h2><i class="fas fa-comments me-2" style="color:var(--ac-lavender)"></i>Discussions r√©centes</h2>
            <a href="{{ path('app_forum_index') }}" class="see-all">Voir tout <i class="fas fa-arrow-right"></i></a>
        </div>
        <div class="row g-3">
            {% for forum in latestForums %}
                <div class="col-md-4">
                    <a href="{{ path('app_forum_show', {id: forum.id}) }}" class="text-decoration-none">
                        <div class="forum-card">
                            <h3>{{ forum.sujet }}</h3>
                            <p>{{ forum.message|length > 120 ? forum.message|slice(0, 120) ~ '‚Ä¶' : forum.message }}</p>
                            <div class="forum-card-meta">
                                <i class="fas fa-user"></i> {{ forum.prenom }} {{ forum.nom }}
                                &middot;
                                <i class="fas fa-clock"></i> {{ forum.dateCreation ? forum.dateCreation|date('d/m/Y') : '' }}
                                {% if forum.reponses|length > 0 %}
                                    &middot;
                                    <i class="fas fa-reply"></i> {{ forum.reponses|length }} r√©ponse{{ forum.reponses|length > 1 ? 's' : '' }}
                                {% endif %}
                            </div>
                        </div>
                    </a>
                </div>
            {% else %}
                <div class="col-12">
                    <div class="text-center text-muted py-4">Aucune discussion pour le moment.</div>
                </div>
            {% endfor %}
        </div>
    </section>

    {# ---------- CTA DONATION BANNER ---------- #}
    <section class="cta-banner mb-5">
        <div class="row align-items-center">
            <div class="col-lg-8">
                <h2 class="mb-2">Soutenez l'art inclusif</h2>
                <p class="mb-lg-0" style="color: rgba(255,255,255,0.85); max-width: 520px;">
                    Votre g√©n√©rosit√© permet aux enfants ayant des besoins sp√©cifiques de s'exprimer √† travers l'art. Chaque don compte.
                </p>
            </div>
            <div class="col-lg-4 text-lg-end">
                <a href="{{ path('app_donation_new') }}" class="btn btn-light btn-hero me-2">
                    <i class="fas fa-hand-holding-heart me-1"></i> Faire un Don
                </a>
                <a href="{{ path('app_donation_my') }}" class="btn btn-outline-light btn-hero">Mes Dons</a>
            </div>
        </div>
    </section>

    {# ---------- ABOUT SECTION ---------- #}
    <section class="about-section mb-4">
        <h2 class="mb-3">√Ä propos d'Art Connect</h2>
        <div class="row g-3">
            <div class="col-md-6 col-lg-3">
                <div class="about-card">
                    <div class="about-icon" style="background: rgba(30,15,117,0.08); color: var(--ac-deep);">
                        <i class="fas fa-palette"></i>
                    </div>
                    <h3 class="h6 fw-bold">Qui sommes-nous ?</h3>
                    <p class="small text-muted mb-0">Une plateforme d√©di√©e √† la promotion de l'art inclusif pour les enfants.</p>
                </div>
            </div>
            <div class="col-md-6 col-lg-3">
                <div class="about-card">
                    <div class="about-icon" style="background: rgba(55,133,216,0.08); color: var(--ac-blue);">
                        <i class="fas fa-bullseye"></i>
                    </div>
                    <h3 class="h6 fw-bold">Notre mission</h3>
                    <p class="small text-muted mb-0">Offrir un acc√®s facile √† des cours artistiques inclusifs encadr√©s par des professionnels.</p>
                </div>
            </div>
            <div class="col-md-6 col-lg-3">
                <div class="about-card">
                    <div class="about-icon" style="background: rgba(191,140,225,0.12); color: var(--ac-lavender);">
                        <i class="fas fa-users"></i>
                    </div>
                    <h3 class="h6 fw-bold">Pour qui ?</h3>
                    <p class="small text-muted mb-0">Enfants de tous √¢ges, avec ou sans besoins sp√©cifiques, et leurs parents.</p>
                </div>
            </div>
            <div class="col-md-6 col-lg-3">
                <div class="about-card">
                    <div class="about-icon" style="background: rgba(235,178,195,0.15); color: #c06080;">
                        <i class="fas fa-heart"></i>
                    </div>
                    <h3 class="h6 fw-bold">Nos valeurs</h3>
                    <p class="small text-muted mb-0">Inclusion, cr√©ativit√©, √©galit√© des chances et impact social positif.</p>
                </div>
            </div>
        </div>
    </section>

{% else %}
    {# ================================================================ #}
    {# GUEST LANDING ‚Äî public homepage                                   #}
    {# ================================================================ #}
    <div class="landing-wrap">
        {# ---------- HERO ---------- #}
        <section class="cta-banner mb-4" style="padding: 3rem 2rem;">
            <h2 class="mb-2" style="font-size: 2rem;">Une plateforme plus simple, plus claire, plus inclusive.</h2>
            <p style="color:rgba(255,255,255,0.88); max-width: 620px;">
                D√©couvrez les √©v√©nements artistiques, la boutique solidaire, le forum et la charit√© en quelques clics.
            </p>
            <a href="{{ path('register') }}" class="btn btn-light btn-hero me-2 mt-2">Inscription</a>
            <a href="{{ path('login') }}" class="btn btn-outline-light btn-hero mt-2">Connexion</a>
        </section>

        {# ---------- EVENTS PREVIEW ---------- #}
        <section class="mb-4">
            <div class="section-head">
                <h2><i class="fas fa-calendar-alt me-2" style="color:var(--ac-mid)"></i>√âv√©nements</h2>
                <a href="{{ path('app_evenement_index') }}" class="see-all">Voir tout <i class="fas fa-arrow-right"></i></a>
            </div>
            <div class="row g-3">
                {% for event in latestEvents|slice(0, 3) %}
                    <div class="col-md-4">
                        <div class="ev-card">
                            <div class="ev-card-img" style="background: linear-gradient({{ loop.index * 40 }}deg, rgba(30,15,117,0.12), rgba(55,133,216,0.12));">
                                {% if event.image %}
                                    <img src="{{ event.image }}" alt="{{ event.titre }}">
                                {% else %}
                                    üé®
                                {% endif %}
                            </div>
                            <div class="ev-card-body">
                                <h3>{{ event.titre }}</h3>
                                <div class="ev-card-meta">
                                    <div><i class="fas fa-clock"></i> {{ event.dateDebut ? event.dateDebut|date('d/m/Y') : '' }}</div>
                                    <div><i class="fas fa-map-marker-alt"></i> {{ event.lieu }}</div>
                                </div>
                                <div class="ev-card-price">
                                    <span class="badge {{ event.prix ? 'bg-warning text-dark' : 'bg-success' }}">
                                        {{ event.prix ? event.prix ~ ' TND' : 'Gratuit' }}
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                {% else %}
                    <div class="col-12"><div class="text-center text-muted py-3">Aucun √©v√©nement pour le moment.</div></div>
                {% endfor %}
            </div>
        </section>

        {# ---------- PRODUCTS PREVIEW ---------- #}
        <section class="mb-4">
            <div class="section-head">
                <h2><i class="fas fa-store me-2" style="color:var(--ac-blue)"></i>Boutique</h2>
                <a href="{{ path('app_produit_index') }}" class="see-all">Voir tout <i class="fas fa-arrow-right"></i></a>
            </div>
            <div class="row g-3">
                {% for produit in latestProduits|slice(0, 4) %}
                    <div class="col-sm-6 col-lg-3">
                        <div class="prod-card">
                            <div class="prod-card-img">
                                {% if produit.image %}
                                    <img src="{{ produit.image }}" alt="{{ produit.nom }}">
                                {% else %}
                                    üõçÔ∏è
                                {% endif %}
                            </div>
                            <div class="prod-card-body">
                                <h3>{{ produit.nom }}</h3>
                                <p>{{ produit.description|length > 80 ? produit.description|slice(0, 80) ~ '‚Ä¶' : produit.description }}</p>
                                <div class="prod-card-foot">
                                    <span class="prod-price">{{ produit.prix }} TND</span>
                                </div>
                            </div>
                        </div>
                    </div>
                {% else %}
                    <div class="col-12"><div class="text-center text-muted py-3">Aucun produit pour le moment.</div></div>
                {% endfor %}
            </div>
        </section>

        {# ---------- CTA ---------- #}
        <section class="cta-banner mb-4">
            <div class="row align-items-center">
                <div class="col-lg-8">
                    <h2 class="mb-2">Pr√™t √† commencer ?</h2>
                    <p class="mb-lg-0" style="color:rgba(255,255,255,0.85);">Cr√©ez votre compte et acc√©dez √† tous les √©v√©nements, la boutique et le forum.</p>
                </div>
                <div class="col-lg-4 text-lg-end mt-3 mt-lg-0">
                    <a href="{{ path('register') }}" class="btn btn-light btn-hero">Cr√©er un compte</a>
                </div>
            </div>
        </section>

        {# ---------- ABOUT ---------- #}
        <section class="about-section mb-3">
            <h2 class="mb-3">√Ä propos d'Art Connect</h2>
            <div class="row g-3">
                <div class="col-md-6 col-lg-3">
                    <div class="about-card">
                        <div class="about-icon" style="background: rgba(30,15,117,0.08); color: var(--ac-deep);"><i class="fas fa-palette"></i></div>
                        <h3 class="h6 fw-bold">Qui sommes-nous ?</h3>
                        <p class="small text-muted mb-0">Une plateforme d√©di√©e √† l'art inclusif pour les enfants.</p>
                    </div>
                </div>
                <div class="col-md-6 col-lg-3">
                    <div class="about-card">
                        <div class="about-icon" style="background: rgba(55,133,216,0.08); color: var(--ac-blue);"><i class="fas fa-bullseye"></i></div>
                        <h3 class="h6 fw-bold">Notre mission</h3>
                        <p class="small text-muted mb-0">Des cours artistiques inclusifs pour tous.</p>
                    </div>
                </div>
                <div class="col-md-6 col-lg-3">
                    <div class="about-card">
                        <div class="about-icon" style="background: rgba(191,140,225,0.12); color: var(--ac-lavender);"><i class="fas fa-users"></i></div>
                        <h3 class="h6 fw-bold">Pour qui ?</h3>
                        <p class="small text-muted mb-0">Enfants de tous √¢ges et leurs parents.</p>
                    </div>
                </div>
                <div class="col-md-6 col-lg-3">
                    <div class="about-card">
                        <div class="about-icon" style="background: rgba(235,178,195,0.15); color: #c06080;"><i class="fas fa-heart"></i></div>
                        <h3 class="h6 fw-bold">Nos valeurs</h3>
                        <p class="small text-muted mb-0">Inclusion, cr√©ativit√© et impact social.</p>
                    </div>
                </div>
            </div>
        </section>
    </div>
{% endif %}
{% endblock %}
